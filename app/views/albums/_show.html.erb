<%- session_key_name = ActionController::Base.session_options[:key] -%>
<%= stylesheet( 'uploadify') %> 
<%= javascript_include_tag "top_up/top_up-min.js"%>
<%= javascript_include_tag "uploadify/swfobject" %>
<%= javascript_include_tag "uploadify/jquery.uploadify.v2.1.0.min" %>


<script type="text/javascript" charset="utf-8"> 
  $(document).ready(function() {
      $('#asset_photo').click(function(event){ 
        event.preventDefault();
        }); 
      $('#asset_photo').uploadify({
        'uploader'  : '/javascripts/uploadify/uploadify.swf', 
        'script'    : '/assets/create', 
        'multi'     : true, 
        'auto'      : true,
        'buttonText': 'Upload Photos',
        'cancelImg' : '/images/cancel.png',
        onComplete : function(event, queueID, fileObj, response, data) { var dat = eval('(' + response + ')');$.getScript(dat.asset);},
        'scriptData': { '<%= session_key_name %>' : encodeURIComponent('<%= u cookies[session_key_name] %>'), 
        'authenticity_token' : encodeURIComponent('<%= u form_authenticity_token if protect_against_forgery? %>'),
        'album_id' : '<%= @album.id %>',
        'format'  : 'json' }
        });
      $('#asset_submit').click(function(event){ 
        event.preventDefault(); 
        $('#asset_photo').uploadifyUpload(); 
        });
        /*
      $(window).keypress(function(event) {
        if (event.keyCode == '39') {
          alert('Right Arrow');
        } else if (event.keyCode == '37') {
          alert('Left Arrow');
        }
      });
        */
  }); 
  
  TopUp.images_path = "/images/top_up/";
  TopUp.addPresets({
      "#asset_list a": {
        title: "Gallery {alt} ({current} of {total})",
        group: "asset_group",
        readAltText: 0,
        effect: "switch",
        overlayClose: 1,
        resizable: 1,
        layout: "flatlook",
        shaded: 1
      }
  });
  
</script>
